<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Motion Ime Fest Live Ranking</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
/* Encrypted CSS - DO NOT DECODE */
@import url("data:text/css;base64,LyogRW5jcnlwdGVkIENTUyAtIERPIE5PVCBERUNPREUgKi8KYm9keSB7Zm9udC1mYW1pbHk6J0ludGVyJywnc2Fucy1zZXJpZic7YmFja2dyb3VuZDpyYWRpYWwtZ3JhZGllbnQoY2lyY2xlIGF0IHRvcCBsZWZ0LCMwYTBmMWMsIzAwMCk7Y29sb3I6I2YwZjRmYTttYXJnaW46MDtwYWRkaW5nOjIwcHg7b3ZlcmZsb3cteDpoaWRkZW47bWluLWhlaWdodDoxMDB2aDstd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7LW1vei11c2VyLXNlbGVjdDpub25lOy1tcy11c2VyLXNlbGVjdDpub25lO3VzZXItc2VsZWN0Om5vbmU7cG9zaXRpb246cmVsYXRpdmV9LmNvbnRhaW5lcnttYXgtd2lkdGg6MTIwMHB4O21hcmdpbjowIGF1dG99LmhlYWRlcnt0ZXh0LWFsaWduOmNlbnRlcjttYXJnaW4tYm90dG9tOjMwcHh9aDF7Zm9udC1zaXplOjIuMmVtO21hcmdpbi1ib3R0b206NXB4O2NvbG9yOiMxZTg4ZTU7Zm9udC13ZWlnaHQ6NzAwfS5zdWJ0aXRsZXt0ZXh0LWFsaWduOmNlbnRlcjtmb250LXNpemU6MS4xZW07Y29sb3I6IzY0YjVmNjttYXJnaW4tdG9wOjA7bWFyZ2luLWJvdHRvbToyNXB4fS5jYXJke2JhY2tncm91bmQ6cmdiYSgxMyw3MSwxNjEsMC4xKTtib3JkZXItcmFkaXVzOjE1cHg7cGFkZGluZzoyMHB4O2JveC1zaGFkb3c6MCA4cHggMzJweCByZ2JhKDAsMCwwLDAuMyk7YmFja2Ryb3AtZmlsdGVyOmJsdXIoMTBweCk7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDMwLDEzNiwyMjksMC4yKX10YWJsZXt3aWR0aDoxMDAlO2JvcmRlci1jb2xsYXBzZTpjb2xsYXBzZTtib3JkZXItcmFkaXVzOjEwcHg7b3ZlcmZsb3c6aGlkZGVuO2ZvbnQtc2l6ZToxNXB4fXRoZWFke2JhY2tncm91bmQ6cmdiYSgxMyw3MSwxNjEsMC4zKX10aCx0ZHtwYWRkaW5nOjE0cHggMTZweDt0ZXh0LWFsaWduOmxlZnR9dGh7Zm9udC13ZWlnaHQ6NjAwO2NvbG9yOiM2NGI1ZjZ9dGJvZHkgdHJ7dHJhbnNpdGlvbjphbGwgMC4zcyBlYXNlO2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHJnYmEoMzAsMTM2LDIyOSwwLjEpfXRib2R5IHRyOmxhc3QtY2hpbGR7Ym9yZGVyLWJvdHRvbTpub25lfXRib2R5IHRyOmhvdmVye2JhY2tncm91bmQ6cmdiYSgzMCwxMzYsMjI5LDAuMSk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTJweCl9LnJhbmstMXtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCg5MGRlZyxyZ2JhKDI1NSwxNTIsMCwwLjIpLHRyYW5zcGFyZW50KTtib3JkZXItbGVmdDo0cHggc29saWQgI2ZmOTgwMH0ucmFuay0ye2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDkwZGVnLHJnYmEoMTg5LDE4OSwxODksMC4yKSx0cmFuc3BhcmVudCk7Ym9yZGVyLWxlZnQ6NHB4IHNvbGlkICNiZGJkYmR9LnJhbmstM3tiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCg5MGRlZyxyZ2JhKDE0MSwxMTAsOTksMC4yKSx0cmFuc3BhcmVudCk7Ym9yZGVyLWxlZnQ6NHB4IHNvbGlkICM4ZDZlNjN9LnVwe2NvbG9yOiM0Y2FmNTA7Zm9udC13ZWlnaHQ6NjAwfS5kb3due2NvbG9yOiNmNDQzMzY7Zm9udC13ZWlnaHQ6NjAwfWZvb3Rlcnt0ZXh0LWFsaWduOmNlbnRlcjttYXJnaW4tdG9wOjMwcHg7Zm9udC1zaXplOjEzcHg7Y29sb3I6IzY0YjVmNn0jc3RhdHVze3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToxNHB4O2NvbG9yOiM2NGI1ZjY7bWFyZ2luLXRvcDoxMHB4O21hcmdpbi1ib3R0b206MjBweDtwYWRkaW5nOjEwcHg7Ym9yZGVyLXJhZGl1czo4cHg7YmFja2dyb3VuZDpyZ2JhKDMwLDEzNiwyMjksMC4xKX0ubG9hZGluZ3t0ZXh0LWFsaWduOmNlbnRlcjtjb2xvcjojNjRiNWY2O2ZvbnQtc2l6ZToxNHB4fS5zdGF0dXMtdXBkYXRle2NvbG9yOiM0Y2FmNTB9LnN0YXR1cy1lcnJvcntjb2xvcjojZjQ0MzM2fUBtZWRpYSAobWF4LXdpZHRoOjc2OHB4KXsqOmZvY3Vze291dGxpbmU6bm9uZX1ib2R5e3BhZGRpbmc6MTBweH1oMXtmb250LXNpemU6MS44ZW19LmNhcmR7cGFkZGluZzoxNXB4fXRhYmxle2ZvbnQtc2l6ZToxNHB4fXRoLHRke3BhZGRpbmc6MTBweCA4cHh9fS5wdWxzZXthbmltYXRpb246cHVsc2UgMnMgaW5maW5pdGV9QGtleWZyYW1lcyBwdWxzZXswJXtvcGFjaXR5OjF9NTAle29wYWNpdHk6MC43fTEwMCV7b3BhY2l0eToxfX0=</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>📊 Motion Ime Fest — Live Vote Rankings</h1>
    <h2 class="subtitle">Newcomer Streamer of the Year</h2>
  </div>

  <div id="status" class="loading pulse">Loading data...</div>

  <div class="card">
    <table id="rankingTable">
      <thead>
        <tr>
          <th>Rank</th>
          <th>Name</th>
          <th>Votes</th>
          <th>Δ Votes</th>
          <th>Views</th>
          <th>Last Updated</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <footer>⚡ Data auto-refresh setiap 5 detik</footer>
</div>

<script>
// Deteksi developer tools dengan multiple methods
(function() {
    'use strict';
    
    // Method 1: Check window size difference
    function checkWindowSize() {
        const threshold = 160;
        const widthDiff = window.outerWidth - window.innerWidth;
        const heightDiff = window.outerHeight - window.innerHeight;
        return widthDiff > threshold || heightDiff > threshold;
    }
    
    // Method 2: Check debugger
    function checkDebugger() {
        const startTime = performance.now();
        debugger;
        const endTime = performance.now();
        return endTime - startTime > 100;
    }
    
    // Method 3: Check console
    function checkConsole() {
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        document.body.appendChild(iframe);
        const result = iframe.contentWindow.console !== window.console;
        document.body.removeChild(iframe);
        return result;
    }
    
    // Check periodically
    setInterval(() => {
        if (checkWindowSize() || checkConsole()) {
            document.body.innerHTML = '<div style="display:flex;justify-content:center;align-items:center;height:100vh;color:white;font-size:18px;font-family:Arial">Access Restricted - Please close developer tools</div>';
            window.stop();
            throw new Error('Security Violation');
        }
    }, 500);
    
    // Override console methods
    ['log', 'error', 'warn', 'info', 'debug'].forEach(method => {
        const original = console[method];
        console[method] = function() {
            if (method === 'error') {
                original.apply(console, ['An error occurred']);
            } else {
                original.apply(console, ['']);
            }
        };
    });
})();

// Advanced API obfuscation
function getSecureApiEndpoint() {
    // Multiple layer obfuscation
    const part1 = "Z2VuZXJpY2g="; // generich
    const part2 = "bXk="; // my
    const part3 = "aWQ="; // id
    const part4 = "YXBpdm90ZQ=="; // apivote
    
    const decodeAndRotate = (str, shift) => {
        const decoded = atob(str);
        return decoded.split('').map(c => {
            const code = c.charCodeAt(0);
            return String.fromCharCode(code - shift);
        }).join('');
    };
    
    const domain = decodeAndRotate(part2, 0) + '.' + decodeAndRotate(part3, 0);
    const path = decodeAndRotate(part4, 0);
    const host = decodeAndRotate(part1, 0);
    
    return `https://${host}.${domain}/${path}`;
}

// Secure fetch with multiple protection layers
async function secureFetch() {
    const timestamp = Date.now();
    const nonce = btoa(timestamp).replace(/[=+/]/g, '');
    
    try {
        const apiUrl = getSecureApiEndpoint();
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 10000);
        
        const response = await fetch(`${apiUrl}?_=${timestamp}&nonce=${nonce}`, {
            method: 'GET',
            mode: 'cors',
            cache: 'no-store',
            credentials: 'omit',
            referrer: 'no-referrer',
            referrerPolicy: 'no-referrer',
            signal: controller.signal,
            headers: {
                'Accept': 'application/json',
                'X-Requested-With': 'XMLHttpRequest',
                'X-Timestamp': timestamp,
                'X-Nonce': nonce,
                'Cache-Control': 'no-cache, no-store, must-revalidate',
                'Pragma': 'no-cache',
                'Expires': '0'
            }
        });
        
        clearTimeout(timeoutId);
        
        if (!response.ok) {
            throw new Error(`Network error: ${response.status}`);
        }
        
        const data = await response.json();
        
        // Validate response structure
        if (!data || typeof data !== 'object' || !data.success || !Array.isArray(data.data)) {
            throw new Error('Invalid response format');
        }
        
        return data;
        
    } catch (error) {
        // Generic error message
        throw new Error('Failed to fetch data');
    }
}

// Main application logic
const REFRESH_INTERVAL = 5000;
let previousData = {};
let isInitialLoad = true;

function formatNumber(num) {
    return new Intl.NumberFormat('en-US').format(num);
}

function getVoteChangeIndicator(change) {
    if (change > 0) {
        return `<span class="up">+${change}</span>`;
    } else if (change < 0) {
        return `<span class="down">${change}</span>`;
    } else {
        return `<span style="color:#64b5f6">0</span>`;
    }
}

async function updateRankings() {
    const statusElement = document.getElementById('status');
    
    try {
        const apiData = await secureFetch();
        const sortedData = apiData.data.sort((a, b) => b.votes - a.votes);
        const tableBody = document.querySelector('#rankingTable tbody');
        
        tableBody.innerHTML = '';
        
        sortedData.forEach((item, index) => {
            const previousVotes = previousData[item.id]?.votes || item.votes;
            const voteChange = item.votes - previousVotes;
            
            const row = document.createElement('tr');
            
            // Apply ranking styles
            if (index === 0) row.className = 'rank-1';
            else if (index === 1) row.className = 'rank-2';
            else if (index === 2) row.className = 'rank-3';
            
            row.innerHTML = `
                <td>#${index + 1}</td>
                <td>${item.name}</td>
                <td>${formatNumber(item.votes)}</td>
                <td>${getVoteChangeIndicator(voteChange)}</td>
                <td>${formatNumber(item.views)}</td>
                <td>${new Date(item.lastUpdated).toLocaleTimeString()}</td>
            `;
            
            tableBody.appendChild(row);
            previousData[item.id] = { votes: item.votes, views: item.views };
        });
        
        const totalVotes = apiData.totals?.votes ? formatNumber(apiData.totals.votes) : '-';
        const totalViews = apiData.totals?.views ? formatNumber(apiData.totals.views) : '-';
        
        statusElement.innerHTML = `<span class="status-update">✅ Updated ${new Date(apiData.timestamp).toLocaleTimeString()} — Total Votes: ${totalVotes}, Views: ${totalViews}</span>`;
        statusElement.classList.remove('loading', 'pulse');
        
        isInitialLoad = false;
        
    } catch (error) {
        console.error('Data fetch error');
        statusElement.innerHTML = `<span class="status-error">❌ Unable to load data. Please try again later.</span>`;
        statusElement.classList.remove('loading', 'pulse');
    }
}

// Initialize application
(function initApp() {
    'use strict';
    
    // Prevent right-click
    document.addEventListener('contextmenu', e => e.preventDefault());
    
    // Prevent keyboard shortcuts
    document.addEventListener('keydown', e => {
        if (e.ctrlKey && (e.key === 'u' || e.key === 'U' || e.key === 's' || e.key === 'S')) {
            e.preventDefault();
        }
        if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
            e.preventDefault();
        }
    });
    
    // Start data updates
    updateRankings();
    setInterval(updateRankings, REFRESH_INTERVAL);
})();
</script>
</body>
</html>
